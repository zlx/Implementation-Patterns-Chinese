## 第5章  类

类的出现要追溯到柏拉图时代。柏拉图式的固体是一种类型，世界上可见的一种形式。柏拉图式球体更加贴切但它不够坚固。我们身边到处可以碰到的球形，它们有时候并不完美。

面向对象编程以一种后西方哲学式的方法捡起了这种概念，将程序划分为类。类描述了一堆相似东西的通用特征，而对象就是这些东西。

类在交流时很重要，因为他们潜在地描述了许多特定的东西。类层次的模式拥有实现模式中最长的持续时间。相比之下，设计模式，主要在探讨类之间的关系。

这章节中出现的模式：

+ 类				-----  使用一个类是指：它包含了一些数据和一些逻辑
+ 简化父类名		-----  用一个简单的名字命名类继承结构的根
+ 合理化子类名	-----  命名子类时要突出与父类之间的联系和差异
+ 抽象接口		-----  从实现中分离出接口
+ 接口			-----  特指不经常变化的抽象接口
+ 接口版本化		-----  安全地扩展接口
+ 抽象类			-----  特指某一个可能会被抽象类导致变化的抽象接口
+ 值对象			-----  一个就像数字一样与状态无关的对象
+ 特质化			-----  清晰地表明关联计算中的相似点和不同点
+ 子类			-----  表示普通的子类
+ 实现			-----  用一个方法类包含一系列计算
+ 内部类			-----  在私有类内部打包一些有用的代码
+ 特定对象行为	-----  特定实例的逻辑
+ 附加条件		-----  明确的条件的逻辑
+ 代理			-----  把一系列逻辑代理到某个对象
+ 可插拔选择器	-----  仔细执行一个方法的一系列逻辑
+ 匿名内部类		-----  在方法中覆盖某几个其它方法的一系列逻辑
+ 库类			-----  保存一系列不属于任何对象的静态方法

### 类

数据比逻辑容易改变。正因为如此，类才有用。每个类都在宣告：逻辑被有序组织，比其操作的数据更稳定，而数据被其相关的逻辑用于操作并发生改变。但是，数据会发生改变，逻辑不会变，这件事也不是绝对的。有时候不同的数据值导致逻辑不太一样，有时候不同的条件也会导致逻辑很不相同。而有时候在一个计算进程里面数据不会发生变化。 学习如何将逻辑打包成一个类和区分逻辑中容易变化的部分是进行有效的对象编程的一部分。

将类合理组织是某种形式上的压缩，抽离出父类并在用于子类。向所有压缩技术一样，这导致代码异常难读。你必须理解父类，才能明白子类干了什么。

谨慎地使用继承是进行有效编程的另一方面。创建一个之类就表示：我和父类很像，但是也有不一样。（还记得覆写父类的方法吗？如果我们每次都慎重的选择隐喻，我们会更加擅长编程。）

类比对象的代价要昂贵得多。一个类应该做一些重要的事情。减少我们系统中的类是一种进步，就像我们要避免类变得臃肿一样。

以下的模式解释了我们如何和清晰的类交流。

### 简化父类名

找寻合适的名字是编程过程中最让人满足的时刻。你要和一个个观点作斗争。久而久之，代码就变得异常复杂，尽管它可以变得更好。然后，我们经常听到有人说：“对，这已经（修改名字）在计划当中”。恰当的名字可以帮助之后的简化和改进。

而最最重要的是挑选类名。类是程序设计里面的最关键部分。一旦类名确定了，他的操作名字也确定了。反过来的情况却很罕见，除非刚开始类名就被随意确定。

给类命名时通常会纠结于保持简洁还是含义丰富。比如说可能会有如下关于类名的对话：“你在换算前记得转换了吗？”这时候，名字应该是简洁有力的。然后，有时候为了让名字清晰，我们需要好几个单词来表达。

走出这种困境的做法是使用一些计算领域的隐喻。使用隐喻，即使是一个简单的单词也会带来丰富的含义。比如说，在一个叫 HotDraw 的画图框架里面，我给画图用的一个对象取的第一个名字是 DrawingObject。沃德· 库宁汉姆 总是意味着排版的创始人：画图就像打印一样，也是如何排列页面。页面上的绘画元素都是图形，所以这个类可以叫做 Figure 。使用了隐喻， Figure 比 DrawingObject 更简短，含义更加丰富也更加明确。

有时候，好名字需要花时间。你可能已经写完了代码，甚至过去了好几个礼拜，好几个月，甚至于好几年，突然，你找到一个更好的名字。有时候，你很难确定用哪一个名字：翻遍同义词典，写下来一堆看上去都合适的名字。有时候，你需要忘记它们的功能，相信时间，你的潜意识会帮你选一个好名字。

交流一直是一个找到一个好名字的好办法。对别人解释这个对象的目标和作用可以让我获得更多的理解和想象。这些想象可能导致我找到一个新名字。

给每个重要的类找一个单个单词的名字。

### 合理化子类名

之类的名字有两个功能。它们需要表达它（该子类）像谁并且（与父类比）有什么不同。同样的，它们也需要均衡简洁和含义。不像父类，之类名不会经常在对话中使用，所以它不需要为了简洁牺牲含义。可以在父类名上面添加一些修饰语来命名子类。

一个例外情况是，如果子类是严格地用来实现某种机制并且在其中有扮演了一个重要的角色。这时候，需要给子类一个像父类一样简洁的名字。比如说：HotDraw 有一个类叫 Handle 用来完成特定图形的绘制工作。所以，尽管它扩展了 Figure，它也有一个简洁的名字 Handle。 Handle 有一个完整的继承体系，他们大多数被命名为 StretchyHandle TransparencyHandle 等等。因为 Handle 是他自己的继承体系的根结点，他作为一个简单的父类，而不是合理的子类。

另外一个关于子类命名的麻烦是多继承。多继承体系经常在代理时出现，但是它们同样需要一个好名字。这时候，你要尝试从读者的角度考虑，而不是单纯地在父类名上面附加修饰语。想象别人希望知道这个类更像那个类，用这个父类名作为基本元素。

和别人交流是类名的最终目的。如果考虑到计算机，类名只需要方便计数即可。太长的名字不容易读写。类名应该尽可能地减少占用读者的短期记忆。孤立的类不容易理解和记忆。用类名来讲述你的代码故事。

   